# Comparative genomics in fungi

```sh
wget --no-check-certificate -O data/seqs/A_flav_SU-16.fna.gz  \
https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/009/856/665/GCA_009856665.1_ASM985666v1/GCA_009856665.1_ASM985666v1_genomic.fna.gz

wget --no-check-certificate -O data/seqs/A_flav_CA14.fna.gz  \
https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/014/784/225/GCA_014784225.1_ASM1478422v1/GCA_014784225.1_ASM1478422v1_genomic.fna.gz

```

```sh
minimap2 -t10 -xc ams5 data/seqs/A_flav_CA14.fna.gz data/seqs/A_flav_NRRL 3357.fna.gz > data/ali/aflav_ali.paf
```

```{r}
library(pafr)

asper <- read_paf("data/ali/aflav_ali.paf")
asper
```

```{r}
asper_clean <- filter_secondary_alignments(asper)
dotplot(asper_clean, order_by="qstart", label_seqs=TRUE)
```

```{r}
plot_synteny(asper, t_chrom="CP061809.1", q_chrom="CP047251.1", rc=TRUE)
```

```{r}
inv <- subset(asper, tname=="CP061809.1" & qname=="CP047251.1" & strand=="+")
inversion_intervals <-  query_bed(inv)
head(inversion_intervals)
```


```{r}
write_bed(inv, "data/results/inversion_query.bed")
```

```{sh}
bedtools merge -d 5000 -i inversion.bed
```

# Comparing draft and finished genome assemblies

```sh
wget -O data/seqs/kea.fna.gz https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/696/875/GCA_000696875.1_ASM69687v1/GCA_000696875.1_ASM69687v1_genomic.fna.gz
wget -O data/seqs/kakapo.fna.gz https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/004/027/225/GCA_004027225.2_bStrHab1.2.pri/GCA_004027225.2_bStrHab1.2.pri_genomic.fna.gz
```

```sh
minimap2 -t20  -cx asm20 data/seqs/kea.fna.gz data/seqs/kakapo.fna.gz | gzip > data/ali/parrots.paf.gz
```

```{r}
parrots <- read_paf("data/ali/parrots.paf.gz")
hq_parrots <- subset(filter_secondary_alignments(parrots), mapq > 50)
hq_parrots

```{r}
dotplot(hq_parrots, order_by="qstart", dashes=FALSE ,label_seqs=TRUE) +
    theme_bw()
```

```{r}
kea_wing <- "#D73202"
ggplot(hq_parrots, aes(alen/tlen)) + 
    geom_histogram(fill=kea_wing, colour='black', binwidth=0.05) + 
    scale_x_continuous()
```

```{r}
subset(hq_parrots, alen /tlen > 0.99)
```

```{r}
sex_chrom_map <- c("CM013773.2" = "Z", "CM013763.2" = "W")
sex_chrom_ali <- subset(hq_parrots, qname %in% names(sex_chrom_map))
sex_chrom_ali$qname <- sex_chrom_map[sex_chrom_ali$qname]
dotplot(sex_chrom_ali, order_by="qstart" ,label_seqs=TRUE, dashes=FALSE)
```


